<style>
  img {
    width: 80px;
  }
  .img-product {
    width: 100%;
  }
  .dataTables_info {
    display: none;
  }
  /* Add your custom table styles here */
  .custom-table {
  width: 100%;
  margin-top: 20px;
  margin-bottom: 20px;
  }
  .table-responsive::-webkit-scrollbar {
  display: none;
}
  .custom-table th,
  .custom-table td {
   
    text-align: center;
    border: none;
  }
  .custom-table th {
    background-color: #f2f2f2;
  }
  .custom-table img {
    width: 80px;
    height: auto;
    display: block;
    margin: 0 auto;
  }
  .custom-table td:hover {
    background-color: #f5f5f5;
 
  }
  #search-results {
      list-style-type: none;
      margin-left: 110px;
      margin-right: 100px;
    }

    .result-item {
      padding: 5px;
    

      cursor: pointer;
    }
    .result-item:hover {
      background-color: #e0e0e0;}
</style>

  <div class="container-fluid">

    <!-- Breadcrumbs -->
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="index.html">Home</a>
      </li>
      <li class="breadcrumb-item active"> POS</li>
      
    </ol>
    <!-- Page Content -->
    <!-- DataTables Example -->

    <div class="row">


      <div class="col-md-7 ">
        <div class="row">
          <div class="table-responsive">
            <div class="custom-table-wrapper" id="cart-items" style="max-height: 300px; overflow-y: auto;">

              <table class="table table-striped table-bordered"  id="selectedTable">
                <thead>
                  <th>Mã hàng</th>
                  <th>Tên sản phẩm</th>
                  <th>Số lượng</th>
                  <th>Giá bán</th>
                  <th>Thành tiền</th>
                  <th></th>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div style="position: fixed; bottom: 0; left: 250px ; width:50% ;">
            <div class="row alert alert-success" >
              Gõ mã hoặc tên sản phẩm vào hộp hộp tìm kiếm để thêm hàng vào đơn hàng
          </div>
          <div class="row">
            
              <div class="card-body">
                <div class="table-responsive">
                  <div class="custom-table-wrapper"> <!-- Add a wrapper div for the table -->
                    <table class="custom-table" id="dataTable">
                      <thead>
                        <tr>
                          <th></th>
                          <th></th>
                          <th></th>
                          <th></th>
                          <th></th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <img src="images/ip15.png" alt="ip15" class="img-product">
                            <div class="card-body">
                              <h5 class="card-title">S00001</h5>
                              <p class="card-text">Price: 10 $</p>
                              <button class="btn btn-blue add-to-cart" data-productid="S00001" data-price="10" data-name="Vivo" data-image="images/ip15.png"><i class="fas fa-shopping-cart"></i></button>
                            </div>
                          </td>
                          <td>
                            <img src="images/ip15.png" alt="ip15" class="img-product">
                            <div class="card-body">
                              <h5 class="card-title">S00002</h5>
                              <p class="card-text">Price: 10 $</p>
                              <button class="btn btn-blue add-to-cart" data-productid="S00002" data-price="10" data-name="Vivo" data-image="images/ip15.png"><i class="fas fa-shopping-cart"></i></button>
                            </div>
                          </td>
                            <td>
                              <img src="images/ip15.png" alt="ip15" class="img-product">
                              <div class="card-body">
                                <h5 class="card-title">S00003</h5>
                                <p class="card-text">Price: 10 $</p>
                                <button class="btn btn-blue add-to-cart" data-productid="S00003" data-price="10" data-name="Vivo" data-image="images/ip15.png"><i class="fas fa-shopping-cart"></i></button>
                              </div>
                            </td>
                            <td>
                              <img src="images/ip15.png" alt="ip15" class="img-product">
                              <div class="card-body">
                                <h5 class="card-title">S00004</h5>
                                <p class="card-text">Price: 10 $</p>
                                <button class="btn btn-blue add-to-cart" data-productid="S00004" data-price="10" data-name="Vivo" data-image="images/ip15.png"><i class="fas fa-shopping-cart"></i></button>
                              </div>
                            </td>
                              <td>
                                <img src="images/ip15.png" alt="ip15" class="img-product">
                                <div class="card-body">
                                  <h5 class="card-title">S00005</h5>
                                  <p class="card-text">Price: 10 $</p>
                                  <button class="btn btn-blue add-to-cart" data-productid="S00005" data-price="10" data-name="Vivo" data-image="images/ip15.png"><i class="fas fa-shopping-cart"></i></button>
                              </div>
                            </td>
                              <td>
                                <img src="images/ip15.png" alt="ip15" class="img-product">
                                <div class="card-body">
                                  <h5 class="card-title">S00006</h5>
                                  <p class="card-text">Price: 10 $</p>
                                  <button class="btn btn-blue add-to-cart" data-productid="S00006" data-price="10" data-name="Vivo" data-image="images/ip15.png"><i class="fas fa-shopping-cart"></i></button>
                                </div>
                              </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </div>
      <div class="col-md-5" style="padding-left: 100px;">
          <form>
             <div class="form-group row">
                <label for="tenKH" class="col-sm-3 col-form-label"><b>Khách hàng</b></label>
                <div class="col-sm-7">
                  <input type="text" class="form-control" id="search-input" placeholder="Tìm khách hàng" oninput="updateOptions(this.value)">
                </div>
                <a href="#" class="btn btn-primary col-sm-1" data-toggle="modal" data-target="#addCustomer">
                  <span>
                    <i class="fa fa-plus"></i>
                  </span>
                </a>
            </div>
              <ul id="search-results"></ul>
              <div class="form-group row">
                <label for="slNV" class="col-sm-3 col-form-label"><b>Nhân viên</b></label>
                <div class="col-sm-7">
                  <select class="form-control" id="slNV">
                    <!-- Add your options here -->
                    <option value="option">--</option>
                    <option value="option1">Option 1</option>
                    <option value="option2">Option 2</option>
                    <option value="option3">Option 3</option>
                    <!-- Add more options as needed -->
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-sm-3 col-form-label" for="ghichu"><b>Ghi chú</b></label>
                <div class="col-sm-7">
                  <textarea class="form-control" id="ghichu" rows="3"></textarea>
                </div>
              </div>
          </form>
          <br>
          <br>
          <h2><i class="fas fa-circle-info"></i>&#x000A;Thông tin thanh toán</h2>
          <form>
            <div class="form-group row">
              <label for="hinhthuc" class="col-sm-3 col-form-label"><b>Hình thức</b></label>
              <div class="col-sm-7">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="hinhthuc" id="radio1" value="option1">
                  <label class="form-check-label" for="radio1">
                    Tiền mặt
                  </label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="hinhthuc" id="radio2" value="option2">
                  <label class="form-check-label" for="radio2">
                    Thẻ
                  </label>
                </div>
              </div>
            </div>
              <div class="form-group row">
                <label for="tienhang" class="col-sm-3 col-form-label"><b>Tiền hàng</b></label>
                <div class="col-sm-7">
                  <span id="total-price">0</span>
                </div>
              </div>
              <div class="form-group row">
                <label for="giamgia" class="col-sm-3 col-form-label"><b>Giảm giá</b></label>
                <div class="col-sm-7">
                  <input type="text" class="form-control text-right" id="giamgia" placeholder="0">
                </div>
              </div>
              <div class="form-group row">
                <label for="tongcong" class="col-sm-3 col-form-label"><b>Tổng cộng</b></label>
                <div class="col-sm-7">
                    <span id="price">0</span>
                </div>
              </div>
              <div class="form-group row">
                <label for="khachdua" class="col-sm-3 col-form-label"><b>Khách đưa</b></label>
                <div class="col-sm-7">
                  <input type="text" class="form-control text-right" id="khachdua" placeholder="0">
                </div>
              </div>
              <div class="form-group row">
                <label for="conno" class="col-sm-3 col-form-label"><b>Còn nợ</b></label>
                <div class="col-sm-7">
                    <span id="conno">0</span>
                </div>
              </div>
               <div class="form-group row">
                <div class="col-sm-3"></div>
                <div class="col-sm-7 text-right">
                  <a href="invoice" class="btn btn-primary">
                    <span>
                      <i class="fa-solid fa-check"></i>&#x000A;Lưu
                    </span>
                  </a>
                  <a href="invoice" class="btn btn-primary">
                    <span><i class="fa-solid fa-print"></i>&#x000A;Lưu và in
                     </span>
                  </a>
                  <a href="#" class="btn btn-link" style="color: black;">
                    <i class="fa-solid fa-arrow-left" ></i> Trở về
                  </a>
                </div>
               </div>
          </form>
      </div>

      </div>

    </div>

</div>
<div class="modal fade" id="addCustomer" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header bg-primary text-white">
              <h5 class="modal-title" id="exampleModalLabel">
                <i class="fa fa-user"></i>
                Thêm khách hàng
              </h5>
              <button class="close text-white" type="button" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
              </button>
            </div>
            <form class="">
              <div class="modal-body">
                <div class="form-group">
                  <label for="">Số điện thoại</label>
                  <input type="text" class="form-control" name="" value="" placeholder="Nhập số điện thoại của khách hàng vào đây..." required>
                </div>
                <div class="form-group">
                  <label for="">Họ và tên</label>
                  <input type="text" class="form-control" name="" value="" placeholder="Nhập họ và tên của khách hàng vào đây...">
                </div>
                <div class="form-group">
                  <label for="">Địa chỉ</label>
                  <input type="email" class="form-control" name="" value="" placeholder="Nhập địa chỉ của khách hàng vào đây...">
                </div>
                <div class="form-group">
                  <label for="">Email</label>
                  <input type="email" class="form-control" name="" value="" placeholder="Nhập email của khách hàng vào đây...">
                </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Thoát</button>
                <input type="submit" class="btn btn-primary" value="Add Employee">
              </div>
            </form>
          </div>
        </div>
      </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>

  $(document).ready(function() {
  var cartItems = []; // Object to store cart items and quantities
  var total = 0;
  var finalprice = 0;
  var discountInput = document.getElementById('giamgia');
  var khachduaInput = document.getElementById('khachdua');
  // Add to cart button click event
  $('.add-to-cart').click(function() {
    var productId = $(this).data('productid');
    var price = $(this).data('price');
    var name = $(this).data('name');
    var index = cartItems.findIndex(function (item) {
      return item.product === productId;
    });

    if (index !== -1) {
      // Product already exists in the cart, update the quantity
      cartItems[index].quantity++;
    } else {
      // Item does not exist in cart, add new item
      cartItems.push({
        product: productId,
        name: name,
        quantity: 1,
        price: price
      });
    }
    var discount = parseFloat(discountInput.value);
    if (discountInput.value === "") {
      discount = 0;
    }
    var priceOutput = document.getElementById('price');
    var finalPrice = total - discount;
    priceOutput.textContent = finalPrice;
    finalprice = finalPrice

    var khachdua = parseFloat(khachduaInput.value);
    if(khachduaInput === ""){
      khachdua = 0;
    }
    var connoOutput = document.getElementById('conno');
    var finalConno = finalprice - khachdua;
    connoOutput = finalConno;
    updateCartTable();
    calculateTotalPrice(); // Update the cart table
  });
  function calculateTotalPrice() {
        var totalPrice = 0;

        for (var i = 0; i < cartItems.length; i++) {
          var item = cartItems[i];
          totalPrice += item.quantity * item.price;
        }
        $('#total-price').text(totalPrice);
        $('#price').text(totalPrice);
        $('#conno').text(totalPrice);
        total = totalPrice;
      }

  // Get the input and output elements

// Add an event listener to the discount input field
  discountInput.addEventListener('input', function() {
  var discountInput = document.getElementById('giamgia');
  var connoOutput = document.getElementById('conno');
  var discount = parseFloat(discountInput.value);
   if (discountInput.value === "") {
      discount = 0;
    }
    var priceOutput = document.getElementById('price');
  var finalPrice = total - discount;
  priceOutput.textContent = finalPrice;
  $('#conno').text(finalPrice);
  finalprice = finalPrice;
});

  khachduaInput.addEventListener('input', function() {
    var khachduaInput = document.getElementById('khachdua');
    var khachdua = parseFloat(khachduaInput.value);
    if (khachduaInput.value === "") {
      khachdua = 0;
    }
    var connoOutput = document.getElementById('conno');
    var finalConno = finalprice - khachdua;
    connoOutput.textContent = finalConno;
  })
  // Function to update the cart table
  function updateCartTable() {
    var cartTable = $('#cart-items tbody'); // Get the cart table body

    // Clear the table body
    cartTable.empty();

    // Iterate over cart items and populate the table
    for (var i = 0; i < cartItems.length; i++) {
      var item = cartItems[i];

      // Calculate the total price for the item
      var totalPrice = item.quantity * item.price;

      // Create a new row for the item
      var row = $('<tr>');
      row.append($('<td>').text(item.product));
      row.append($('<td>').text(item.name));
      var input = $('<input>').attr('type', 'text').val(item.quantity).css('text-align', 'center');
      row.append($('<td>').append(input));      row.append($('<td>').text(item.price));
      row.append($('<td>').text(totalPrice));
      row.append($('<td>').html('<i class="fas fa-trash"></i>'));

      // Append the row to the table body
      cartTable.append(row);
    }
  }
});

  const options = ['Option 1', 'Option 2', 'Option 3', 'Option 4', 'Option 5'];

  function updateOptions(searchTerm) {
    const searchResults = document.getElementById('search-results');
    searchResults.innerHTML = '';

    if (searchTerm.length === 0) {
      return;
    }

    const filteredOptions = options.filter(option =>
      option.toLowerCase().includes(searchTerm.toLowerCase())
    );

    filteredOptions.forEach(option => {
      const listItem = document.createElement('li');
      listItem.classList.add('result-item');
      listItem.textContent = option;
      listItem.addEventListener('click', () => {
        document.getElementById('search-input').value = option;

        searchResults.innerHTML = '';
      });
      searchResults.appendChild(listItem);
    });
  }
            
</script>